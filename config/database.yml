shared_db_settings: &shared_db_settings
  adapter: postgresql
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %>
  variables:
    statement_timeout: 20000
    idle_in_transaction_session_timeout: 10000

default_primary: &default_primary
  <<: *shared_db_settings
  database: "<%= ENV['DB_DATABASE'] %>"
  username: "<%= ENV['DB_USERNAME'] %>"
  password: "<%= ENV['DB_PASSWORD'] %>"
  host: "<%= ENV['DB_HOSTNAME'] %>"
  port: "<%= ENV['DB_PORT'] %>"
default_npq_registration: &default_npq_registration
  <<: *shared_db_settings
  migrations_paths: db/npq_registration_migrate
  database: "<%= ENV['NPQ_REG_DB_DATABASE'] %>"
  username: "<%= ENV['NPQ_REG_DB_USERNAME'] %>"
  password: "<%= ENV['NPQ_REG_DB_PASSWORD'] %>"
  host: "<%= ENV['NPQ_REG_DB_HOSTNAME'] %>"
  port: "<%= ENV['NPQ_REG_DB_PORT'] %>"

development:
  primary:
    <<: *default_primary
    database: early_careers_framework_development
  npq_registration:
    <<: *default_npq_registration
    database: npq_registration_development

migration:
  <<: *default
  url: <%= ENV["DATABASE_URL"] %>

test:
  primary:
    <<: *default_primary
    database: early_careers_framework_test<%= ENV['TEST_ENV_NUMBER'] %>
    variables:
      idle_in_transaction_session_timeout: 0
  npq_registration:
    <<: *default_npq_registration
    database: npq_registration_test
    variables:
      idle_in_transaction_session_timeout: 0

review:
  primary:
    <<: *default_primary
    sslmode: <%= ENV.fetch("DB_SSLMODE") { "require" } %>
  npq_registration:
    <<: *default_npq_registration
    sslmode: <%= ENV.fetch("DB_SSLMODE") { "require" } %>

performance:
  primary:
    <<: *default_primary
    database: early_careers_framework_performance
  npq_registration:
    <<: *default_npq_registration
    database: npq_registration_performance

staging:
  primary:
    <<: *default_primary
  npq_registration:
    <<: *default_npq_registration

sandbox:
  primary:
    <<: *default_primary
  npq_registration:
    <<: *default_npq_registration


production:
  primary:
    <<: *default_primary
  npq_registration:
    <<: *default_npq_registration

