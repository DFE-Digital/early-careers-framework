<%= govuk_summary_list do |sl|
  sl.row do |row|
    row.key(text: "Full name")
    row.value(text: @participant_presenter.full_name)
    unless @participant_profile.user.get_an_identity_id.present?
      row.action(
        href: edit_admin_participant_change_name_path(@participant_profile),
        visually_hidden_text: "name"
      )
    end
  end

  sl.row do |row|
    row.key(text: "User email address")
    row.value(text: @participant_presenter.email)
    unless @participant_profile.user.get_an_identity_id.present?
      row.action(
        href: edit_admin_participant_change_email_path(@participant_profile),
        visually_hidden_text: "email"
      )
    end
  end

  if policy(:super_user).show?
    sl.row do |row|
      row.key(text: "Participant identity")
      row.value(text: @participant_presenter.participant_identity.email)
    end
  end

  sl.row do |row|
    row.key(text: "Date of birth")
    row.value(text: @participant_presenter&.ecf_participant_validation_data&.date_of_birth&.to_s(:govuk))
  end

  sl.row do |row|
    row.key(text: "Training status")
    row.value(text: @participant_presenter.training_status)
  end

  sl.row do |row|
    row.key(text: "Profile status")
    row.value(text: @participant_presenter.status)
  end

  if @participant_presenter.teacher_profile
    sl.row do |row|
      row.key(text: "TRN")
      row.value(text: @participant_presenter.teacher_profile.trn)
    end
  end

  sl.row do |row|
    row.key(text: "Profile ID")
    row.value(text: tag.code(@participant_presenter.id))
  end

  sl.row do |row|
    row.key(text: "User ID")
    row.value(text: tag.code(@participant_presenter.user_id))
  end

  sl.row do |row|
    row.key(text: "External ID")
    row.value(text: tag.code(@participant_presenter.participant_identity.external_identifier))
  end

  sl.row do |row|
    row.key(text: "Associated email addresses")
    row.value(text: html_list(all_emails_associated_with_a_user(@participant_profile.user)))
  end

  sl.row do |row|
    row.key(text: "Training record state")
    row.value(text: render(StatusTags::AdminParticipantStatusTag.new(participant_profile: @participant_profile)))
  end

  sl.row do |row|
    row.key(text: "Notes")

    row.value do
      if @participant_presenter.notes?
        simple_format(@participant_presenter.notes, class: "govuk-body")
      else
        "No notes"
      end
    end

    notes_present = @participant_presenter.notes.present?

    row.action(
      text: notes_present ? "Change notes" : "Add notes",
      href: edit_admin_note_path(@participant_profile),
      visually_hidden_text: notes_present ? "on #{@participant_presenter.full_name}'s profile" : "to #{@participant_presenter.full_name}'s profile",
    )
  end
end %>
