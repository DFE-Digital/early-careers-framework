<% title = "Test Data" %>
<% content_for :title, title %>

<span class="govuk-caption-xl">Schools that have chosen CIP for <%= Cohort.current.academic_year %></span>
<h1 class="govuk-heading-xl"><%= title %></h1>

<%= render partial: "admin/test_data/nav" %>

<div class="nhsuk-table-container">
  <table class="govuk-table nhsuk-table-responsive">
    <thead class="nhsuk-table__head">
      <tr class="govuk-table__row">
        <th scope="col" class="govuk-table__header">URN</th>
        <th scope="col" class="govuk-table__header">Name</th>
        <th scope="col" class="govuk-table__header">Materials</th>
        <th scope="col" class="govuk-table__header">Induction tutor</th>
      </tr>
    </thead>
    <tbody class="govuk-table__body nhsuk-table__body">
      <% @schools.each do |school| %>
        <tr class="govuk-table__row nhsuk-table__row">
          <td class="govuk-table__cell nhsuk-table__cell">
            <span class="nhsuk-table-responsive__heading">URN</span>
            <%= school.urn %>
          </td>
          <td class="govuk-table__cell nhsuk-table__cell">
            <span class="nhsuk-table-responsive__heading">School</span>
            <%= govuk_link_to school.name, admin_school_path(school) %>
          </td>
          <td class="govuk-table__cell nhsuk-table__cell">
            <span class="nhsuk-table-responsive__heading">Materials</span>
            <% programme = school.school_cohorts.where(cohort: Cohort.current).first.default_induction_programme %>
            <%= "#{programme&.core_induction_programme&.name.presence || "-"}" %> 
          </td>
          <td class="govuk-table__cell nhsuk-table__cell">
            <span class="nhsuk-table-responsive__heading">Induction tutor</span>
            <%= school.induction_coordinators.first&.email || "- <span class='govuk-visually-hidden'>No induction tutor</span>".html_safe %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<%= govuk_pagination(pagy: @pagy) %>
