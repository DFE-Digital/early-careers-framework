<%= govuk_breadcrumbs breadcrumbs: course_lesson_breadcrumbs(@current_user, @course_lesson_part.course_lesson) %>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    <% if policy(@course_lesson_part.course_lesson).edit? %>
      <%= link_to "Edit lesson", edit_cip_year_module_lesson_path(id: @course_lesson_part.course_lesson.id), class: "govuk-button" %>
    <% end %>
    <% if policy(@course_lesson_part).edit? %>
      <%= link_to "Edit lesson content", edit_cip_year_module_lesson_part_path(@course_lesson_part), class: "govuk-button" %>
    <% end %>

    <h1 class="govuk-heading-xl"> <%= @course_lesson_part.course_lesson.title %></h1>
    <h2 class="govuk-heading-l"> <%= @course_lesson_part.title %></h2>

    <div class="gem-c-govspeak govuk-govspeak ">
      <%= @course_lesson_part.content_to_html.html_safe %>
    </div>

    <% if policy(@course_lesson_part.course_lesson).set_progress? %>
      <%= form_with url: cip_year_module_lesson_progress_path(lesson_id: @course_lesson_part.course_lesson.id), method: :put do |f| %>
        <%= f.govuk_collection_check_boxes(
              :progress,
              [OpenStruct.new(id: :complete, name: "I feel confident that I've read and understood this session")],
              :id,
              :name,
              legend: {text: "That's the end of this session"}) %>
        <%= f.govuk_submit "Complete session" %>
      <% end %>
    <% end %>

  </div>
</div>
