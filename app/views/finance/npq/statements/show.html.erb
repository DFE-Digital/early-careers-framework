<% content_for :title, t("finance.npq.payment_breakdown") %>
<% content_for :before_content, govuk_back_link(text: "Back", href: select_provider_npq_finance_payment_breakdowns_path) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <h1 class="govuk-heading-xl">National professional qualifications (NPQs)</h1>

    <span class="govuk-caption-l"><%= @statement.cpd_lead_provider.name %></span>
    <h2 class="govuk-heading-l"><%= @statement.name %></h2>

    <%= render Finance::Statements::StatementSelector.new(current_statement: @statement)  %>

    <p class="govuk-caption-m govuk-!-margin-0">Payment of</p>
    <h2 class="govuk-heading-xl govuk-!-margin-0"><%= number_to_pounds aggregated_payment(@breakdowns) + aggregated_vat(@breakdowns, @npq_lead_provider) %></h2>
    <p class="govuk-caption-m govuk-!-margin-top-0">On or after <%= @statement.payment_date.to_s(:govuk) %></p>

    <%= render Finance::NPQ::PaymentOverviews::References.new(@statement) %>

    <h2 class="govuk-heading-m"><%=t("finance.npq.payment_breakdown") %></h2>

    <table class="govuk-table payment-breakdown-table">
      <tbody>
        <%= render Finance::NPQ::PaymentOverviews::PaymentCoursesRow.with_collection(@breakdowns, statement: @statement, npq_lead_provider: @npq_lead_provider) %>

        <tr class="govuk-table__row">
          <td class="govuk-table__cell"><%= t("finance.vat") %></td>
          <td class="govuk-table__cell govuk-table__cell--numeric"><%= number_to_pounds aggregated_vat(@breakdowns, @npq_lead_provider) %></td>
        </tr>

        <%= render Finance::NPQ::PaymentOverviews::TotalPaymentCoursesRow.new(@breakdowns, statement: @statement, npq_lead_provider: @npq_lead_provider) %>
      </tbody>
    </table>
  </div>
</div>

<ul class="govuk-list">
  <li><%= govuk_link_to t("finance.show_voided_declarations"), voided_finance_npq_lead_provider_statement_path(@npq_lead_provider.id, @statement) %></li>
  <li><%= govuk_link_to t("finance.show_contract"), finance_npq_contract_path(id: @npq_lead_provider.id) %></li>
</ul>
