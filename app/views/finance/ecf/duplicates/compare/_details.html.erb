<%= govuk_table do |table|
  table.head do |head|
    head.row do |row|
      row.cell(header: true, text: "Profile type")
      row.cell(header: true, text: "Participant ID")
      row.cell(header: true, text: "Profile ID")
      row.cell(header: true, text: "Cohort")
      row.cell(header: true, text: "Schedule")
      row.cell(header: true, text: "Induction status")
      row.cell(header: true, text: "Training status")
      row.cell(header: true, text: "Lead Provider")
      row.cell(header: true, text: "School")
      row.cell(header: true, text: "Starts on")
      row.cell(header: true, text: "Ends on")
      row.cell(header: true, text: "Declaration count")
    end

    table.body do |body|
      body.row do |row|
        row.cell { tag_for(participant_profile) }
        row.cell(text: participant_profile.participant_id)
        row.cell(text: participant_profile.id)
        row.cell(text: participant_profile.cohort)
        row.cell(text: participant_profile.schedule_identifier)
        row.cell(text: participant_profile.induction_status)
        row.cell(text: participant_profile.training_status)
        row.cell(text: participant_profile.provider_name)
        row.cell(text: participant_profile.school_name)
        row.cell(text: participant_profile.start_date.to_s(:govuk))
        row.cell(text: participant_profile.end_date&.to_s(:govuk))
        row.cell(text: participant_profile.declaration_count)
      end
    end
  end
end %>

<%= govuk_accordion do |accordion|
  accordion.section(heading_text: "Views induction records") do
    govuk_table do |table|
      table.head do |head|
        head.row do |row|
          row.cell(header: true, text: "Lead provider")
          row.cell(header: true, text: "Cohort")
          row.cell(header: true, text: "Schedule")
          row.cell(header: true, text: "Start date")
          row.cell(header: true, text: "End date")
          row.cell(header: true, text: "Preferred email")
          row.cell(header: true, text: "Induction status")
          row.cell(header: true, text: "Training status")
        end

        table.body do |body|
          participant_profile.induction_records.each do |induction_record|
            body.row do |row|
              row.cell(text: induction_record.lead_provider.name)
              row.cell(text: induction_record.cohort.start_year)
              row.cell(text: induction_record.schedule.schedule_identifier)
              row.cell(text: induction_record.start_date.to_s(:govuk))
              row.cell(text: induction_record.end_date&.to_s(:govuk))
              row.cell(text: induction_record.preferred_identity.email)
              row.cell(text: induction_record.induction_status)
              row.cell(text: induction_record.training_status)
            end
          end
        end
      end
    end
  end
end %>
